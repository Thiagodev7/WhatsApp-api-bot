<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infinity Dashboard | Gestor IA</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <img src="logo.jpeg" alt="Logo" style="height: 45px;">
        </div>
        <nav class="nav-menu">
            <a class="nav-item active" onclick="showTab('home', this)">
                <span class="material-icons-round">space_dashboard</span><span>Dashboard</span>
            </a>
            <a class="nav-item" onclick="showTab('agenda', this)">
                <span class="material-icons-round">calendar_month</span><span>Agenda</span>
            </a>
            <a class="nav-item" onclick="showTab('chat', this)">
                <span class="material-icons-round">chat</span><span>Atendimento</span>
            </a>
            <a class="nav-item" onclick="authSettings(this)">
                <span class="material-icons-round">tune</span><span>Configura√ß√µes</span>
            </a>
        </nav>
        <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border);">
            <a class="nav-item" style="color:var(--danger);" onclick="logout()">
                <span class="material-icons-round">power_settings_new</span><span>Reiniciar</span>
            </a>
        </div>
    </aside>

    <main class="main">
        <header class="header">
            <div>
                <h2 id="page-title" style="font-weight:700;">Dashboard</h2>
                <p style="font-size:0.85rem; color:var(--text-muted);">Status do Sistema</p>
            </div>
            <div style="display:flex; align-items:center; gap:8px; padding:6px 12px; background:#ecfdf5; border-radius:20px; border:1px solid #d1fae5;">
                <div id="status-dot" style="width:8px; height:8px; border-radius:50%; background:var(--success);"></div>
                <span id="status-text" style="font-size:0.8rem; font-weight:600; color:var(--success);">Online</span>
            </div>
        </header>

        <div id="qr-overlay" class="qr-overlay">
            <h2 style="margin-bottom:20px;">Conectar WhatsApp</h2>
            <div class="qr-box" id="qr-box"></div>
            <p style="margin-top:20px; color:var(--text-muted);">Abra o WhatsApp > Aparelhos Conectados > Conectar</p>
        </div>

        <div id="view-home" class="view active" style="padding: 30px 40px;">
            <div class="grid-3">
                <div class="widget"><span class="widget-label">Agendamentos</span><div class="widget-value" id="total-apps">0</div></div>
                <div class="widget"><span class="widget-label">Mensagens Hoje</span><div class="widget-value" id="total-msgs">0</div></div>
                <div class="widget"><span class="widget-label">Status</span><div class="widget-value" style="color:var(--success);">Ativo</div></div>
            </div>
            <h3 style="margin-bottom:20px;">Pr√≥ximos Clientes</h3>
            <div id="recent-list" class="agenda-grid"></div>
        </div>

        <div id="view-agenda" class="view" style="padding: 30px 40px;">
            <div class="agenda-layout">
                <div class="agenda-sidebar">
                    <button class="btn btn-primary" style="width:100%; justify-content:center;" onclick="refreshData()">
                        <span class="material-icons-round">refresh</span> Atualizar Agenda
                    </button>
                    <div class="cal-widget">
                        <div class="cal-header"><span>Novembro 2025</span></div>
                        <div class="cal-grid">
                            <span>D</span><span>S</span><span>T</span><span>Q</span><span>Q</span><span>S</span><span>S</span>
                            <span class="cal-day">1</span><span class="cal-day">2</span><span class="cal-day">3</span><span class="cal-day">4</span><span class="cal-day">5</span><span class="cal-day">6</span><span class="cal-day">7</span>
                            <span class="cal-day">8</span><span class="cal-day">9</span><span class="cal-day">10</span><span class="cal-day">11</span><span class="cal-day">12</span><span class="cal-day">13</span><span class="cal-day">14</span>
                            <span class="cal-day">15</span><span class="cal-day">16</span><span class="cal-day">17</span><span class="cal-day">18</span><span class="cal-day">19</span><span class="cal-day has-event">20</span><span class="cal-day">21</span>
                            <span class="cal-day">22</span><span class="cal-day">23</span><span class="cal-day">24</span><span class="cal-day has-event">25</span><span class="cal-day active">26</span><span class="cal-day">27</span><span class="cal-day">28</span>
                        </div>
                    </div>
                    <div class="widget" style="text-align:center;">
                        <span style="font-size:3rem;">üìÖ</span>
                        <h3 style="margin-top:10px;">Hoje</h3>
                        <p style="color:var(--text-muted);">Voc√™ tem clientes agendados.</p>
                    </div>
                </div>
                <div class="timeline-container" id="agenda-timeline">
                    <div style="text-align:center; color:var(--text-muted); margin-top:50px;">Carregando agenda...</div>
                </div>
            </div>
        </div>

        <div id="view-chat" class="view" style="padding:0; overflow:hidden;">
            <div class="chat-layout">
                <div class="chat-sidebar">
                    <div class="chat-search"><input type="text" class="search-input" placeholder="Buscar conversa..." onkeyup="filterContacts(this.value)"></div>
                    <div class="contact-list" id="contact-list"></div>
                </div>
                <div class="chat-main" id="chat-main">
                    <div id="chat-header-bar" class="chat-header-bar" style="display:none;">
                        <button onclick="closeChatMobile()" class="mobile-only" style="border:none; background:none; font-size:1.5rem; margin-right:10px;">‚¨ÖÔ∏è</button>
                        <div id="active-avatar" class="avatar">?</div>
                        <div>
                            <div id="active-name" style="font-weight:700;">Nome</div>
                            <div style="font-size:0.75rem; color:var(--text-muted);">Atendimento via Bot</div>
                        </div>
                    </div>
                    <div id="chat-feed" class="chat-messages">
                        <div class="empty-state">
                            <span class="material-icons-round" style="font-size:4rem; color:#cbd5e1;">chat</span>
                            <p>Selecione uma conversa para ver o hist√≥rico.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-settings" class="view" style="padding: 30px 40px;">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3>Personalizar IA</h3><br>
                    <div class="shortcuts">
                        <div class="pill" onclick="fill('config_prompt', 'Voc√™ √© a assistente...')">ü§ñ Personalidade</div>
                        <div class="pill" onclick="fill('config_numeros', '5511...')">üö´ Bloqueio</div>
                        <div class="pill" onclick="fill('corte', 'R$ 50')">‚úÇÔ∏è Servi√ßo</div>
                    </div>
                    <input id="cfg-key" class="input" placeholder="Chave">
                    <textarea id="cfg-val" class="input textarea" placeholder="Valor"></textarea>
                    <button class="btn btn-primary" onclick="saveConfig()">Salvar</button>
                    <div id="config-list" style="margin-top:20px;"></div>
                </div>
                <div class="settings-card">
                    <h3>Sistema</h3><br>
                    <button class="btn btn-danger" onclick="disconnectWhatsapp()">Desconectar WhatsApp</button>
                </div>
            </div>
        </div>
    </main>

    <div class="toast" id="toast">Salvo!</div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>