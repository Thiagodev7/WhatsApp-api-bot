name: Deploy Autom√°tico VPS

on:
  push:
    branches: [ "main" ]

jobs:
  deploy:
    name: Deploy para Produ√ß√£o
    runs-on: ubuntu-latest

    steps:
    - name: Executando comandos SSH na VPS
      uses: appleboy/ssh-action@v1.0.3
      with:
        host: ${{ secrets.HOST }}
        username: ${{ secrets.USERNAME }}
        password: ${{ secrets.PASSWORD }}
        port: 22
        script: |
          # 1. Entra na pasta do projeto (ajuste se o nome for diferente)
          cd ~/whatsapp-api-bot
          
          # 2. For√ßa a atualiza√ß√£o do c√≥digo (descarta mudan√ßas locais para evitar conflito)
          git fetch --all
          git reset --hard origin/main
          
          # 3. Instala depend√™ncias novas (caso tenha)
          npm install
          
          # 4. Reinicia o Bot e salva
          pm2 restart bot-zap
          pm2 save
          
          echo "üöÄ Deploy conclu√≠do com sucesso!"